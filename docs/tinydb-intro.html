<!DOCTYPE html>
<html lang="en">

<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">


        <title>TinyDB the NoSQL alternative to SQLlite</title>

            <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Python Monthly Full Atom Feed" />
            <link href="/feeds/python.atom.xml" type="application/atom+xml" rel="alternate" title="Python Monthly Categories Atom Feed" />
        <!-- Bootstrap Core CSS -->
        <link href="/theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="/theme/css/clean-blog.min.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="/theme/css/code_blocks/darkly.css" rel="stylesheet">


        <!-- Custom Fonts -->
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->



        <meta name="description" content="A Introduction to Tinydb the NoSQL alternative to SQLite for a Self-contained, File Based, Document Oriented database, thats really small!">

        <meta name="author" content="TJ Nel">

        <meta name="tags" content="Databases">
        <meta name="tags" content="NoSQL">

	                <meta property="og:locale" content="">
		<meta property="og:site_name" content="Python Monthly">

	<meta property="og:type" content="article">
            <meta property="article:author" content="/author/tj-nel.html">
	<meta property="og:url" content="/tinydb-intro.html">
	<meta property="og:title" content="TinyDB the NoSQL alternative to SQLlite">
	<meta property="article:published_time" content="2010-12-22 08:30:00-08:00">
            <meta property="og:description" content="A Introduction to Tinydb the NoSQL alternative to SQLite for a Self-contained, File Based, Document Oriented database, thats really small!">

            <meta property="og:image" content="/theme/images/post-bg.jpg">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Python Monthly</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                        <li><a href="https://www.youtube.com/channel/UC7ROIuBkGtLpCIMsgoIwv0Q">YouTube</a></li>
                        <li><a href="http://pythonmonthly.com/category/videos.html">Videos</a></li>

                            <li><a href="/pages/about.html">About</a></li>
                            <li><a href="/pages/code-of-conduct.html">Code of Conduct</a></li>
                            <li><a href="/pages/contributors.html">Contributors</a></li>
                            <li><a href="/pages/join-our-slack-team.html">Join our Slack Team</a></li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('/theme/images/post-bg.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>TinyDB the NoSQL alternative to SQLlite</h1>
                        <span class="meta">Posted by
                                <a href="/author/tj-nel.html">TJ Nel</a>
                             on Wed 22 December 2010
                        </span>
                            <span class="meta">Updated on Wed 22 December 2010</span>
                        
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <!-- Post Content -->
    <article>
        <h3>A introduction to Tinydb the NoSQL alternative to SQLite for a self contained, serverless database.</h3>
<p>Let face it the future of the internet revolves around APIs, we are in a data-driven world and the format that we move this data is JSON. So it would be logical to have a database that speaks JSON and NoSQL database often provide a JSON like syntax that work well with this data.
<strong>enter TinyDB...</strong>
<a href="https://tinydb.readthedocs.io">TinyDB</a> is a Document oriented NoSQL database that was written with only about 1200 lines of code! Just like with SQLite, TinyDB is great for quick and small scoped projects and testing. The database is stored in a .json file which as you guessed it is a simple json file that you can query later.Best of all it is written in good 'ole Python.</p>
<h4>Example: Storing API Responses with TinyDB</h4>
<p>In this example I am going to show you how to store a json formatted API response to a TinyDB databate. From there you can add, remove and modify entries within the database. </p>
<h4>Installing TinyDB</h4>
<p>You can install TinyDB using PIP.</p>
<div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">tinydb</span>
</pre></div>


<h4>Using TinyDB</h4>
<p>Just like with any other python module you can import TinyDB but it is best practice to import the submodules TinyDB and Query (see below).</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tinydb</span> <span class="kn">import</span> <span class="n">TinyDB</span><span class="p">,</span> <span class="n">Query</span>
</pre></div>


<p>Then you will need to create a database object</p>
<div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">TinyDB</span><span class="p">(</span><span class="s1">&#39;dbname.json&#39;</span><span class="p">)</span>
</pre></div>


<p>After that you are all set, just work directly with the database object you just created.</p>
<h4>Setting up your API Call</h4>
<p>For this example we will be using the People In Space API available from <a href="http://open-notify.org/Open-Notify-API/People-In-Space/">Open Notify</a>. This API return a list of all of the members currently on the International Space Station. To use this API you need to sent a HTTP request to <strong>http://api.open-notify.org/astros.json</strong> with no authentication or parameters required and you will get back a JSON formatted response with all of the current astronauts on the ISS. So in python the request to get the JSON back looks like this...</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://api.open-notify.org/astros.json&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>


<p>So if we print data we should get the following output:</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>


<blockquote>
<p>{'number': 6, 'people': [{'craft': 'ISS', 'name': 'Sergey Rizhikov'}, {'craft': &gt;'ISS', 'name': 'Andrey Borisenko'}, {'craft': 'ISS', 'name': 'Shane Kimbrough'}, {'craft': 'ISS', 'name': 'Oleg Novitskiy'}, {'craft': 'ISS', 'name': 'Thomas Pesquet'}, {'craft': 'ISS', 'name': 'Peggy Whitson'}], 'message': 'success'}</p>
</blockquote>
<h4>Adding API Call Results to TinyDB</h4>
<p>Now we want to put the people from that JSON response into a TinyDB database. So to do  this we need to learn how to add a entry into a TinyDB database. TinyDB has a couple of functions that allow you to modify the database file you are working with. 
<strong>Inserting Data</strong>
To insert or add data into your database you would use <code>db.insert(...)</code> 
<strong>Updating Data</strong>
To update information in your database you would use <code>db.update(fields, query)</code> this works by updating all elements matching the query with fields.</p>
<p>Right now we want to add every entry from the list of people in space so we will be using insert. So if we wanted to add the Sergey Rizhikov from the data above we would use the syntax <code>db.insert({'craft': 'ISS', 'name': 'Sergey Rizhikov'})</code>.  But we dont want to copy-pasta every person in space, so interating through the people section of the JSON output and putting that into the <code>db.insert()</code> statement using the below code should populate our database.</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">person</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;people&#39;</span><span class="p">]:</span>
    <span class="n">db</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>
</pre></div>


<p>and using <code>db.all()</code> which prints out the contents of your tiny database confirms the people were inserted into the database.</p>
<div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>


<blockquote>
<p Whitson_="Whitson'" _ISS_="'ISS'," _Peggy="'Peggy" _craft_:="'craft':" _name_:="'name':">{'craft': 'ISS', 'name': 'Sergey Rizhikov'}
{'craft': 'ISS', 'name': 'Andrey Borisenko'}
{'craft': 'ISS', 'name': 'Shane Kimbrough'}
{'craft': 'ISS', 'name': 'Oleg Novitskiy'}
{'craft': 'ISS', 'name': 'Thomas Pesquet'}</p>
</blockquote>
<h4>Querying the Database</h4>
<p>Now that we have data in our database, it would be useful to be able to retieve from it. TinyDB allows you to query that data by using a Query() object. So if you wanted to get a list of all the people in space on the ISS you can use this code:</p>
<div class="highlight"><pre><span></span><span class="n">Astro</span> <span class="o">=</span> <span class="n">Query</span><span class="p">()</span>
<span class="n">db</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">Astro</span><span class="o">.</span><span class="n">craft</span> <span class="o">==</span> <span class="s1">&#39;ISS&#39;</span><span class="p">)</span>
</pre></div>


<p>Unsuprisingly you will get all of the entries put in with ISS as the craft (which is all of them). But what if you wanted to search for a speciifc person like Peggy? Well you could you use this code:</p>
<div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">Astro</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Peggy&#39;</span><span class="p">))</span>
</pre></div>


<p>Which will return only people with Peggy in their name</p>
<blockquote>
<p>[{'craft': 'ISS', 'name': 'Peggy Whitson'}]</p>
</blockquote>
<p>Modifying the code to search for anyone with <code>'Pe'</code> in their name with this syntax <code>db.search(Astro.name.search('Pe'))</code> returns the following:</p>
<blockquote>
<p>[{'craft': 'ISS', 'name': 'Thomas Pesquet'},
 {'craft': 'ISS', 'name': 'Peggy Whitson'}]</p>
</blockquote>
<h4>Updating the fields in the Database</h4>
<p>Now what if one of the people in space changes the craft they are on from the ISS to Tiangong 1 (We will call it T1) we can update their data by following the syntax we previously talked about. So lets send Peggy Whitson to T1.</p>
<div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;craft&#39;</span><span class="p">:</span><span class="s1">&#39;T1&#39;</span><span class="p">},</span> <span class="n">Astro</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Peggy&#39;</span><span class="p">)</span> <span class="p">)</span>
</pre></div>


<p>Now checking <code>db.all()</code> you should now see Peggy on the T1 craft.</p>
<blockquote>
<p>[{'craft': 'ISS', 'name': 'Sergey Rizhikov'},
 {'craft': 'ISS', 'name': 'Andrey Borisenko'},
 {'craft': 'ISS', 'name': 'Shane Kimbrough'},
 {'craft': 'ISS', 'name': 'Oleg Novitskiy'},
 {'craft': 'ISS', 'name': 'Thomas Pesquet'},
 {'craft': 'T1', 'name': 'Peggy Whitson'}]</p>
</blockquote>
<h4>Removing Data from the Database</h4>
<p>Lets now send someone home, TinyDB allows you to remove entries in the database using <code>db.remove()</code> where it will remove all of the entries matching the query placed inside of the parenthesis. Lets send Shane home and remove him from the database with the following code:</p>
<div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">Astro</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Shane&#39;</span><span class="p">))</span>
</pre></div>


<p>Now checking <code>db.all()</code> we see that Shane is no longer in the database output.</p>
<blockquote>
<p>[{'craft': 'ISS', 'name': 'Sergey Rizhikov'},
 {'craft': 'ISS', 'name': 'Andrey Borisenko'},
 {'craft': 'ISS', 'name': 'Oleg Novitskiy'},
 {'craft': 'ISS', 'name': 'Thomas Pesquet'},
 {'craft': 'T1', 'name': 'Peggy Whitson'}]
 #### Clearing the database
 Last but not least if you want to clear out the database you can just run <code>db.purge()</code> and you will have a nice and empty database to work with. </p>
</blockquote>
<p>##### For more TinyDB info:
 * https://tinydb.readthedocs.io
 * https://github.com/msiemens/tinydb
 * https://pypi.python.org/pypi/tinydb</p>
    </article>

        <div class="tags">
            <p>tags: <a href="/tag/databases.html">Databases</a>, <a href="/tag/nosql.html">NoSQL</a></p>
        </div>

    <hr>

            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                            <li>
                                <a href="https://github.com/Python-Monthly">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://plus.google.com/112952259748021652374">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-google fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="mailto:info@pythonmonthly.com">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://pythonmonthly.slack.com">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-slack fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://www.youtube.com/channel/UC7ROIuBkGtLpCIMsgoIwv0Q">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-youtube fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                    </ul>
<p class="copyright text-muted">
    Blog powered by <a href="http://getpelican.com">Pelican</a>,
    which takes great advantage of <a href="http://python.org">Python</a>.
</p>                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="/theme/js/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/theme/js/bootstrap.min.js"></script>

        <!-- Custom Theme JavaScript -->
        <script src="/theme/js/clean-blog.min.js"></script>

</body>

</html>